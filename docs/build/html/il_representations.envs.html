

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>il_representations.envs package &mdash; Representations for Sequence Learning 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="il_representations.il package" href="il_representations.il.html" />
    <link rel="prev" title="il_representations.data package" href="il_representations.data.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Representations for Sequence Learning
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">il_representations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="il_representations.html">il_representations package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="il_representations.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="il_representations.algos.html">il_representations.algos package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.configs.html">il_representations.configs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.data.html">il_representations.data package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">il_representations.envs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.il.html">il_representations.il package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.scripts.html">il_representations.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.test_support.html">il_representations.test_support package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.pol_eval">il_representations.pol_eval module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.policy_interfacing">il_representations.policy_interfacing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.script_utils">il_representations.script_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.utils">il_representations.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Representations for Sequence Learning</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">il_representations</a> &raquo;</li>
        
          <li><a href="il_representations.html">il_representations package</a> &raquo;</li>
        
      <li>il_representations.envs package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/il_representations.envs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="il-representations-envs-package">
<h1>il_representations.envs package<a class="headerlink" href="#il-representations-envs-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-il_representations.envs.atari_envs">
<span id="il-representations-envs-atari-envs-module"></span><h2>il_representations.envs.atari_envs module<a class="headerlink" href="#module-il_representations.envs.atari_envs" title="Permalink to this headline">¶</a></h2>
<p>Utilities for working with Atari environments and demonstrations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.atari_envs.load_dataset_atari">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.atari_envs.</span></span><span class="sig-name descname"><span class="pre">load_dataset_atari</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chans_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.atari_envs.load_dataset_atari" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-il_representations.envs.auto">
<span id="il-representations-envs-auto-module"></span><h2>il_representations.envs.auto module<a class="headerlink" href="#module-il_representations.envs.auto" title="Permalink to this headline">¶</a></h2>
<p>Code for automatically loading data, creating vecenvs, etc. based on
Sacred configuration.</p>
<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.benchmark_is_available">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">benchmark_is_available</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.benchmark_is_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the selected benchmark is actually available for use on
this machine. Useful for skipping tests when deps are not installed.</p>
<p>Returns a tuple of <cite>(benchmark_available, message)</cite>: if
<cite>benchmark_available</cite> is <cite>False</cite>, then the <cite>message</cite> is a string explaining
why the benchmark is not available; otherwise, <cite>benchmark_available</cite> is
<cite>True</cite>, and <cite>message</cite> is <cite>None</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.get_data_dir">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">get_data_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_root</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.get_data_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data directory for a given benchmark (“magical”, “dm_control”,
etc.), task (e.g. “MoveToCorner-Demo-v0”, “finger-spin”) and data type
(e.g. “demos”, “random”).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.get_gym_env_name">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">get_gym_env_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_control_full_env_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.get_gym_env_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of the Gym environment corresponding to the current
task.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.load_color_space">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">load_color_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.load_color_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine which colour space is used for this benchmark. This is RGB for
every task except Atari. Knowing the colour space is useful for determining
dimensions of the frame stacks that get passed to CNNs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.load_dict_dataset">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">load_dict_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.load_dict_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a dict-type dataset. Also see load_wds_datasets, which instead
lods a set of datasets that have been stored in a webdataset-compatible
format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.load_vec_env">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">load_vec_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_control_full_env_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_control_frame_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minecraft_max_env_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">procgen_frame_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">procgen_start_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.load_vec_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a vec env for the selected benchmark task and wrap it with any
necessary wrappers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.auto.load_wds_datasets">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.auto.</span></span><span class="sig-name descname"><span class="pre">load_wds_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.auto.load_wds_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Load datasets in webdataset (wds) format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>configs</strong> (<em>[</em><em>dict</em><em>]</em>) – <dl>
<dt>list of dicts with the following keys:</dt><dd><ul class="simple">
<li><p><cite>type</cite>: “random” or “demos”, as appropriate.</p></li>
<li><p><cite>env_cfg</cite>: subset of keys from <cite>env_cfg_ingredient</cite> specifying a</p></li>
</ul>
<p>particular environment name, etc.</p>
</dd>
</dl>
<p>If any of the above keys are missing, they will be filled in with
defaults: <cite>type</cite> defaults to “demos”, and <cite>env_cfg</cite> keys are taken
from <cite>env_cfg_ingredient</cite> by default. Only keys that differ from
those defaults need to be overridden. For instance, if
<cite>env_cfg_ingredient</cite> was configured with
<cite>benchmark_name=”dm_control”</cite>, then you could set <cite>configs =
[{“type”: “random”, “env_cfg”: {“task_name”: “finger_spin”}}]</cite> to use
only rollouts from the <cite>finger-spin</cite> dm_control environment.</p>
</p>
</dd>
</dl>
<p>(all other args are taken from env_data_ingredient)</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.envs.baselines_vendored">
<span id="il-representations-envs-baselines-vendored-module"></span><h2>il_representations.envs.baselines_vendored module<a class="headerlink" href="#module-il_representations.envs.baselines_vendored" title="Permalink to this headline">¶</a></h2>
<p>This file contains functions copied from somewhere else, where our code base
requires some minimal modifications of the original function. This is a more
lightweight solution than some others, e.g., installing a full package just
for one supporting function, or submitting PRs to change the original package.</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecEnvObservationWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.envs.baselines_vendored.</span></span><span class="sig-name descname"><span class="pre">VecEnvObservationWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecEnvObservationWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">stable_baselines3.common.vec_env.base_vec_env.stable_baselines3.common.vec_env.base_vec_env.VecEnvWrapper._name</span></code></p>
<p>Copied from openai/baselines/common/vec_env/vec_env.py.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecEnvObservationWrapper.process">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecEnvObservationWrapper.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecEnvObservationWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecEnvObservationWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecEnvObservationWrapper.step_wait">
<span class="sig-name descname"><span class="pre">step_wait</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecEnvObservationWrapper.step_wait" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecExtractDictObs">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.envs.baselines_vendored.</span></span><span class="sig-name descname"><span class="pre">VecExtractDictObs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecExtractDictObs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">stable_baselines3.common.vec_env.base_vec_env.stable_baselines3.common.vec_env.base_vec_env.VecEnvWrapper._name</span></code></p>
<p>Copied from openai/baselines/common/vec_env/vec_remove_dict_obs.py.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecExtractDictObs.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecExtractDictObs.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecMonitor">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.envs.baselines_vendored.</span></span><span class="sig-name descname"><span class="pre">VecMonitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">stable_baselines3.common.vec_env.base_vec_env.stable_baselines3.common.vec_env.base_vec_env.VecEnvWrapper._name</span></code></p>
<p>Modified from openai/baselines/common/vec_env/vec_monitor.py. The imitation
package requires the environment to return ‘terminal_observation’ as part
of the step info, so we add it here.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecMonitor.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecMonitor.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.baselines_vendored.VecMonitor.step_wait">
<span class="sig-name descname"><span class="pre">step_wait</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.baselines_vendored.VecMonitor.step_wait" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-il_representations.envs.config">
<span id="il-representations-envs-config-module"></span><h2>il_representations.envs.config module<a class="headerlink" href="#module-il_representations.envs.config" title="Permalink to this headline">¶</a></h2>
<p>Common config utilities for all benchmarks, including configuration
variables for creating environments (<cite>env_cfg_ingredient</cite>), for creating
vecenvs (<cite>venv_opts_ingredient</cite>), and for loading data
(<cite>env_data_ingredient</cite>).</p>
</div>
<div class="section" id="module-il_representations.envs.dm_control_envs">
<span id="il-representations-envs-dm-control-envs-module"></span><h2>il_representations.envs.dm_control_envs module<a class="headerlink" href="#module-il_representations.envs.dm_control_envs" title="Permalink to this headline">¶</a></h2>
<p>Importing this file will automatically register all relevant DM-Control
environments with Gym.</p>
<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.dm_control_envs.load_dataset_dm_control">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.dm_control_envs.</span></span><span class="sig-name descname"><span class="pre">load_dataset_dm_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_control_full_env_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_control_frame_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.dm_control_envs.load_dataset_dm_control" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.dm_control_envs.register_dmc_envs">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.dm_control_envs.</span></span><span class="sig-name descname"><span class="pre">register_dmc_envs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.dm_control_envs.register_dmc_envs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.dm_control_envs.rewrite_dataset_dm_control">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.dm_control_envs.</span></span><span class="sig-name descname"><span class="pre">rewrite_dataset_dm_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_control_full_env_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_data_root</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.dm_control_envs.rewrite_dataset_dm_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate a dm_control dataset to some new length.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.envs.magical_envs">
<span id="il-representations-envs-magical-envs-module"></span><h2>il_representations.envs.magical_envs module<a class="headerlink" href="#module-il_representations.envs.magical_envs" title="Permalink to this headline">¶</a></h2>
<p>Importing this file automatically registers all relevant MAGICAL
environments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.SB3EvaluationProtocol">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.envs.magical_envs.</span></span><span class="sig-name descname"><span class="pre">SB3EvaluationProtocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.magical_envs.SB3EvaluationProtocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">magical.evaluation.magical.evaluation.EvaluationProtocol._name</span></code></p>
<p>MAGICAL ‘evaluation protocol’ for Stable Baselines 3 policies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.SB3EvaluationProtocol.obtain_scores">
<span class="sig-name descname"><span class="pre">obtain_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">venv_parallel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_envs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.magical_envs.SB3EvaluationProtocol.obtain_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect <cite>self.n_rollouts</cite> scores on environment <cite>env_name</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.SB3EvaluationProtocol.run_id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">run_id</span></span><a class="headerlink" href="#il_representations.envs.magical_envs.SB3EvaluationProtocol.run_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifier for this run in the dataframe produced by
<cite>.do_eval()</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.get_env_name_magical">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.magical_envs.</span></span><span class="sig-name descname"><span class="pre">get_env_name_magical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magical_preproc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.magical_envs.get_env_name_magical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.load_data">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.magical_envs.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pickle_paths</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessor_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_null_actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#il_representations.envs.magical_envs.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load MAGICAL data from pickle files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.load_dataset_magical">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.magical_envs.</span></span><span class="sig-name descname"><span class="pre">load_dataset_magical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magical_preproc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magical_remove_null_actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.magical_envs.load_dataset_magical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.magical_envs.rewrite_dataset_magical">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.magical_envs.</span></span><span class="sig-name descname"><span class="pre">rewrite_dataset_magical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_data_root</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.magical_envs.rewrite_dataset_magical" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate a MAGICAL dataset to some new length.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.envs.minecraft_envs">
<span id="il-representations-envs-minecraft-envs-module"></span><h2>il_representations.envs.minecraft_envs module<a class="headerlink" href="#module-il_representations.envs.minecraft_envs" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.MinecraftVectorWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.envs.minecraft_envs.</span></span><span class="sig-name descname"><span class="pre">MinecraftVectorWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.MinecraftVectorWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.core.Wrapper</span></code></p>
<p>Currently, RepL code only works with pixel inputs, and imitation can only work with vector (rather than dict)
action spaces. So, we currently (1) only allow VectorObfuscated environments (where the action dictionary
has been processed into a vector), and (2) extract the observation space to only save the pixels, before we load
the data in as a il_representations dataset</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.MinecraftVectorWrapper.dictify_action">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">dictify_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.MinecraftVectorWrapper.dictify_action" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.MinecraftVectorWrapper.extract_action">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">extract_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.MinecraftVectorWrapper.extract_action" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.MinecraftVectorWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.MinecraftVectorWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the environment to an initial state and returns an initial
observation.</p>
<p>Note that this function should not reset the environment’s random
number generator(s); random variables in the environment’s state should
be sampled independently between multiple calls to <cite>reset()</cite>. In other
words, each call of <cite>reset()</cite> should yield an environment suitable for
a new episode, independent of previous episodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the initial observation.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>observation (object)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.MinecraftVectorWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.MinecraftVectorWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one timestep of the environment’s dynamics. When end of
episode is reached, you are responsible for calling <cite>reset()</cite>
to reset this environment’s state.</p>
<p>Accepts an action and returns a tuple (observation, reward, done, info).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>object</em>) – an action provided by the agent</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>agent’s observation of the current environment
reward (float) : amount of reward returned after previous action
done (bool): whether the episode has ended, in which case further step() calls will return undefined results
info (dict): contains auxiliary diagnostic information (helpful for debugging, and sometimes learning)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (object)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.MinecraftVectorWrapper.transform_obs">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">transform_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.MinecraftVectorWrapper.transform_obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.channels_first">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.minecraft_envs.</span></span><span class="sig-name descname"><span class="pre">channels_first</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">el</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.channels_first" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.construct_next_obs">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.minecraft_envs.</span></span><span class="sig-name descname"><span class="pre">construct_next_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.construct_next_obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.get_env_name_minecraft">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.minecraft_envs.</span></span><span class="sig-name descname"><span class="pre">get_env_name_minecraft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.get_env_name_minecraft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.minecraft_envs.load_dataset_minecraft">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.minecraft_envs.</span></span><span class="sig-name descname"><span class="pre">load_dataset_minecraft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.minecraft_envs.load_dataset_minecraft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-il_representations.envs.procgen_envs">
<span id="il-representations-envs-procgen-envs-module"></span><h2>il_representations.envs.procgen_envs module<a class="headerlink" href="#module-il_representations.envs.procgen_envs" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.procgen_envs.get_procgen_env_name">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.procgen_envs.</span></span><span class="sig-name descname"><span class="pre">get_procgen_env_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.procgen_envs.get_procgen_env_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.procgen_envs.load_dataset_procgen">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.procgen_envs.</span></span><span class="sig-name descname"><span class="pre">load_dataset_procgen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">procgen_frame_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chans_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.procgen_envs.load_dataset_procgen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-il_representations.envs.utils">
<span id="il-representations-envs-utils-module"></span><h2>il_representations.envs.utils module<a class="headerlink" href="#module-il_representations.envs.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.utils.serialize_gym_space">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.utils.</span></span><span class="sig-name descname"><span class="pre">serialize_gym_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.utils.serialize_gym_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Gym space to a format suitable for long-term pickle storage
(i.e. for pickles that will be transferred between machines running
different versions of Gym).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.envs.utils.stack_obs_oldest_first">
<span class="sig-prename descclassname"><span class="pre">il_representations.envs.utils.</span></span><span class="sig-name descname"><span class="pre">stack_obs_oldest_first</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_zeroed_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.envs.utils.stack_obs_oldest_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an array of shape [T, C, H, W] and stacks the entries to produce a
new array of shape [T, C*frame_stack, H, W] with frames stacked along the
channels axis. Frames are stacked oldest-first.</p>
<p>If use_zeroed_frames=True, the first frame_stack-1 frames have zeros
instead of older frames (because older frames don’t exist). This is
meant to be compatible with VecFrameStack in SB3.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.envs">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-il_representations.envs" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="il_representations.il.html" class="btn btn-neutral float-right" title="il_representations.il package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="il_representations.data.html" class="btn btn-neutral float-left" title="il_representations.data package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Center for Human-Compatible AI.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>