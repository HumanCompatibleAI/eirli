

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>il_representations.algos package &mdash; Representations for Sequence Learning 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="il_representations.configs package" href="il_representations.configs.html" />
    <link rel="prev" title="il_representations package" href="il_representations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Representations for Sequence Learning
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">il_representations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="il_representations.html">il_representations package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="il_representations.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">il_representations.algos package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.configs.html">il_representations.configs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.data.html">il_representations.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.envs.html">il_representations.envs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.il.html">il_representations.il package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.scripts.html">il_representations.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.test_support.html">il_representations.test_support package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.pol_eval">il_representations.pol_eval module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.policy_interfacing">il_representations.policy_interfacing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.script_utils">il_representations.script_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.utils">il_representations.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Representations for Sequence Learning</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">il_representations</a> &raquo;</li>
        
          <li><a href="il_representations.html">il_representations package</a> &raquo;</li>
        
      <li>il_representations.algos package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/il_representations.algos.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="il-representations-algos-package">
<h1>il_representations.algos package<a class="headerlink" href="#il-representations-algos-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-il_representations.algos.augmenters">
<span id="il-representations-algos-augmenters-module"></span><h2>il_representations.algos.augmenters module<a class="headerlink" href="#module-il_representations.algos.augmenters" title="Permalink to this headline">¶</a></h2>
<p>These are pretty basic: when constructed, they take in a list of augmentations, and
either augment just the context, or both the context and the target, depending on the algorithm.</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.AugmentContextAndExtraContext">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.augmenters.</span></span><span class="sig-name descname"><span class="pre">AugmentContextAndExtraContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmenter_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.AugmentContextAndExtraContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.augmenters.AugmentContextOnly" title="il_representations.algos.augmenters.AugmentContextOnly"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.augmenters.AugmentContextOnly</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.AugmentContextAndExtraContext.augment_extra_context">
<span class="sig-name descname"><span class="pre">augment_extra_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_contexts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.AugmentContextAndExtraContext.augment_extra_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.AugmentContextAndTarget">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.augmenters.</span></span><span class="sig-name descname"><span class="pre">AugmentContextAndTarget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmenter_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.AugmentContextAndTarget" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.augmenters.Augmenter" title="il_representations.algos.augmenters.Augmenter"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.augmenters.Augmenter</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.AugmentContextOnly">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.augmenters.</span></span><span class="sig-name descname"><span class="pre">AugmentContextOnly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmenter_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.AugmentContextOnly" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.augmenters.Augmenter" title="il_representations.algos.augmenters.Augmenter"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.augmenters.Augmenter</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.Augmenter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.augmenters.</span></span><span class="sig-name descname"><span class="pre">Augmenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmenter_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.Augmenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.Augmenter.augment_extra_context">
<span class="sig-name descname"><span class="pre">augment_extra_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_contexts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.Augmenter.augment_extra_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.augmenters.NoAugmentation">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.augmenters.</span></span><span class="sig-name descname"><span class="pre">NoAugmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmenter_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.augmenters.NoAugmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.augmenters.Augmenter" title="il_representations.algos.augmenters.Augmenter"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.augmenters.Augmenter</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.base_learner">
<span id="il-representations-algos-base-learner-module"></span><h2>il_representations.algos.base_learner module<a class="headerlink" href="#module-il_representations.algos.base_learner" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.base_learner.BaseEnvironmentLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.base_learner.</span></span><span class="sig-name descname"><span class="pre">BaseEnvironmentLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.base_learner.BaseEnvironmentLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.base_learner.BaseEnvironmentLearner.set_random_seed">
<span class="sig-name descname"><span class="pre">set_random_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.base_learner.BaseEnvironmentLearner.set_random_seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.batch_extenders">
<span id="il-representations-algos-batch-extenders-module"></span><h2>il_representations.algos.batch_extenders module<a class="headerlink" href="#module-il_representations.algos.batch_extenders" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.batch_extenders.BatchExtender">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.batch_extenders.</span></span><span class="sig-name descname"><span class="pre">BatchExtender</span></span><a class="headerlink" href="#il_representations.algos.batch_extenders.BatchExtender" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.batch_extenders.IdentityBatchExtender">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.batch_extenders.</span></span><span class="sig-name descname"><span class="pre">IdentityBatchExtender</span></span><a class="headerlink" href="#il_representations.algos.batch_extenders.IdentityBatchExtender" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.batch_extenders.BatchExtender" title="il_representations.algos.batch_extenders.BatchExtender"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.batch_extenders.BatchExtender</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.batch_extenders.QueueBatchExtender">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.batch_extenders.</span></span><span class="sig-name descname"><span class="pre">QueueBatchExtender</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queue_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.batch_extenders.QueueBatchExtender" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.batch_extenders.BatchExtender" title="il_representations.algos.batch_extenders.BatchExtender"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.batch_extenders.BatchExtender</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.decoders">
<span id="il-representations-algos-decoders-module"></span><h2>il_representations.algos.decoders module<a class="headerlink" href="#module-il_representations.algos.decoders" title="Permalink to this headline">¶</a></h2>
<p>LossDecoders are meant to be mappings between the representation being learned,
and the representation or tensor that is fed directly into the loss. In many cases, these are the
same, and this will just be a NoOp.</p>
<p>Some cases where it is different:
- When you are using a Projection Head in your contrastive loss, and comparing similarities of vectors that are
k &gt;=1 nonlinear layers downstream from the actual representation you’ll use in later tasks
- When you’re learning a VAE, and the loss is determined by how effectively you can reconstruct the image
from a representation vector, the LossDecoder will handle that representation -&gt; image mapping
- When you’re predicting actions given current and next state, you’ll want to predict those actions given
both the representation of the current state, and also information about the next state. This occasional
need for extra information beyond the central context state is why we have <cite>extra_context</cite> as an optional
bit of data that pair constructors can return, to be passed forward for use here</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ActionConditionedVectorDecoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">ActionConditionedVectorDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ActionConditionedVectorDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>A decoder that concatenates the frame representation
and the action representation, and predicts a vector from it
for use in contrastive losses</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ActionConditionedVectorDecoder.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ActionConditionedVectorDecoder.decode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ActionConditionedVectorDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ActionConditionedVectorDecoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ActionPredictionHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">ActionPredictionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ActionPredictionHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>A decoder that takes in two vector representations of frames
(one in context, one in extra_context), and produces a prediction
of the action taken in between the frames</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ActionPredictionHead.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ActionPredictionHead.decode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ActionPredictionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ActionPredictionHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.AsymmetricProjectionHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">AsymmetricProjectionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.AsymmetricProjectionHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.AsymmetricProjectionHead.decode_context">
<span class="sig-name descname"><span class="pre">decode_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.AsymmetricProjectionHead.decode_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.AsymmetricProjectionHead.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.AsymmetricProjectionHead.decode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.AsymmetricProjectionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.AsymmetricProjectionHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.BYOLProjectionHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">BYOLProjectionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.BYOLProjectionHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.BYOLProjectionHead.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.BYOLProjectionHead.decode_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder target/keys using momentum-updated key encoder. Had some thought of making _momentum_update_key_encoder
a backwards hook, but seemed overly complex for an initial proof of concept
:param x:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.BYOLProjectionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.BYOLProjectionHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ContrastiveInverseDynamicsConcatenationHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">ContrastiveInverseDynamicsConcatenationHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ContrastiveInverseDynamicsConcatenationHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ContrastiveInverseDynamicsConcatenationHead.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ContrastiveInverseDynamicsConcatenationHead.decode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ContrastiveInverseDynamicsConcatenationHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ContrastiveInverseDynamicsConcatenationHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ExpSequential">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">ExpSequential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ExpSequential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.ExpSequential.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.ExpSequential.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.LossDecoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">LossDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.LossDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.LossDecoder.decode_context">
<span class="sig-name descname"><span class="pre">decode_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.LossDecoder.decode_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.LossDecoder.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.LossDecoder.decode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.LossDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.LossDecoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.LossDecoder.get_vector">
<span class="sig-name descname"><span class="pre">get_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.LossDecoder.get_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.LossDecoder.ones_like_projection_dim">
<span class="sig-name descname"><span class="pre">ones_like_projection_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.LossDecoder.ones_like_projection_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.MomentumProjectionHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">MomentumProjectionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.MomentumProjectionHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.MomentumProjectionHead.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.MomentumProjectionHead.decode_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder target/keys using momentum-updated key encoder. Had some thought of making _momentum_update_key_encoder
a backwards hook, but seemed overly complex for an initial proof of concept
:param x:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.MomentumProjectionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.MomentumProjectionHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.NoOp">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">NoOp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.NoOp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.NoOp.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.NoOp.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.OnlyTargetProjectionHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">OnlyTargetProjectionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.OnlyTargetProjectionHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.OnlyTargetProjectionHead.decode_context">
<span class="sig-name descname"><span class="pre">decode_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.OnlyTargetProjectionHead.decode_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.OnlyTargetProjectionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.OnlyTargetProjectionHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.PixelDecoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">PixelDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.PixelDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.PixelDecoder.decode_target">
<span class="sig-name descname"><span class="pre">decode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.PixelDecoder.decode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.PixelDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.PixelDecoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.decoders.SymmetricProjectionHead">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">SymmetricProjectionHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.SymmetricProjectionHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.decoders.SymmetricProjectionHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.SymmetricProjectionHead.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.decoders.compute_decoder_input_shape_from_encoder">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">compute_decoder_input_shape_from_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_arch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.compute_decoder_input_shape_from_encoder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.decoders.get_projection_modules">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">get_projection_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">representation_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">architecture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.get_projection_modules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.decoders.get_sequential_from_architecture">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.decoders.</span></span><span class="sig-name descname"><span class="pre">get_sequential_from_architecture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">architecture</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">representation_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection_dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.decoders.get_sequential_from_architecture" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-il_representations.algos.encoders">
<span id="il-representations-algos-encoders-module"></span><h2>il_representations.algos.encoders module<a class="headerlink" href="#module-il_representations.algos.encoders" title="Permalink to this headline">¶</a></h2>
<p>Encoders conceptually serve as the bit of the representation learning
architecture that learns the representation itself (except in RNN cases, where
encoders only learn the per-frame representation).</p>
<p>The only real complex thing to note here is the MomentumEncoder architecture,
which creates two CNNEncoders, and updates weights of one as a slowly moving
average of the other. Note that this bit of momentum is separated from the
creation and filling of a queue of representations, which is handled by the
BatchExtender module</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.ActionEncodingEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">ActionEncodingEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.ActionEncodingEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>An encoder that uses DeterministicEncoder logic for encoding the <cite>context</cite> and <cite>target</cite> pixel frames,
but which encodes an <cite>extra_context</cite> object containing actions into a vector form</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.ActionEncodingEncoder.encode_extra_context">
<span class="sig-name descname"><span class="pre">encode_extra_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.ActionEncodingEncoder.encode_extra_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.ActionEncodingEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.ActionEncodingEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.ActionEncodingInverseDynamicsEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">ActionEncodingInverseDynamicsEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.ActionEncodingInverseDynamicsEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.ActionEncodingInverseDynamicsEncoder.encode_extra_context">
<span class="sig-name descname"><span class="pre">encode_extra_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.ActionEncodingInverseDynamicsEncoder.encode_extra_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.ActionEncodingInverseDynamicsEncoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.ActionEncodingInverseDynamicsEncoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.BaseEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">BaseEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.BaseEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.BaseEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.BaseEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.BaseEncoder.forward_deterministic">
<span class="sig-name descname"><span class="pre">forward_deterministic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.BaseEncoder.forward_deterministic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.BaseEncoder.forward_with_stddev">
<span class="sig-name descname"><span class="pre">forward_with_stddev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.BaseEncoder.forward_with_stddev" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.BasicCNN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">BasicCNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.BasicCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>Similar to the CNN from the Nature DQN paper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.BasicCNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.BasicCNN.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.CoordConv">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">CoordConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.CoordConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>Add coordinates in [0,1] to an image, like CoordConv paper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.CoordConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.CoordConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Encoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">Encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.Encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Encoder.device">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#il_representations.algos.encoders.Encoder.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Encoder.encode_context">
<span class="sig-name descname"><span class="pre">encode_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.Encoder.encode_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Encoder.encode_extra_context">
<span class="sig-name descname"><span class="pre">encode_extra_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.Encoder.encode_extra_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Encoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.Encoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.InverseDynamicsEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">InverseDynamicsEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.InverseDynamicsEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.InverseDynamicsEncoder.encode_extra_context">
<span class="sig-name descname"><span class="pre">encode_extra_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.InverseDynamicsEncoder.encode_extra_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.InverseDynamicsEncoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.InverseDynamicsEncoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.MAGICALCNN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">MAGICALCNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.MAGICALCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>The CNN from the MAGICAL paper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.MAGICALCNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.MAGICALCNN.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.MomentumEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">MomentumEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.MomentumEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.MomentumEncoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.MomentumEncoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder target/keys using momentum-updated key encoder. Had some thought of making _momentum_update_key_encoder
a backwards hook, but seemed overly complex for an initial proof of concept
:param x:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.MomentumEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.MomentumEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.RecurrentEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">RecurrentEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.RecurrentEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.RecurrentEncoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.RecurrentEncoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.RecurrentEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.RecurrentEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.RecurrentEncoder.ones_like_representation_dim">
<span class="sig-name descname"><span class="pre">ones_like_representation_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.RecurrentEncoder.ones_like_representation_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Resnet18">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">Resnet18</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.Resnet18" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torchvision.models.resnet.</span></code></p>
<p>Version of Torch’s resnet18 model. Copied from resnet.py, with some
modifications:</p>
<ul class="simple">
<li><p>Can handle an arbitrary number of input channels, instead of just three
channels.</p></li>
<li><p>Applies CoordConv to counter the way resnet discards spatial information
by average-pooling. I haven’t tested it, but expect it will help a bit
(or at least not hurt).</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.Resnet18.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.Resnet18.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.TargetStoringActionEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">TargetStoringActionEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.TargetStoringActionEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>Identical to VAE encoder, but inherits from ActionEncodingEncoder,
so we get that class’s additional implementation
of <cite>encode_extra_context</cite>. If being used for Dynamics, can use with learn_scale=False. If being used
for TemporalVAE, use learn_scale=True</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.TargetStoringActionEncoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.TargetStoringActionEncoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.encoders.VAEEncoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">VAEEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.VAEEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.</span></code></p>
<p>An encoder that uses a normal encoder’s logic for encoding
context (with learned stddev), but for target, just returns a delta distribution
around ground truth pixels, since we don’t want to vector-encode
them.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.encoders.VAEEncoder.encode_target">
<span class="sig-name descname"><span class="pre">encode_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.VAEEncoder.encode_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.encoders.compute_output_shape">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.compute_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the size of the output after passing an observation from
<cite>observation_space</cite> through the given <cite>layers</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.encoders.compute_rep_shape_encoder">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">compute_rep_shape_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.compute_rep_shape_encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute representation shape for an entire Encoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.encoders.get_obs_encoder_cls">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">get_obs_encoder_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_encoder_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.get_obs_encoder_cls" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.encoders.infer_action_shape_info">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">infer_action_shape_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_embedding_dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.infer_action_shape_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an action_processor, processed_action_dim and action_shape based on the action_space
and the action_embedding_dim</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.encoders.magical_conv_block">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">magical_conv_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_chans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_chans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.magical_conv_block" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.encoders.warn_on_non_image_tensor">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.encoders.</span></span><span class="sig-name descname"><span class="pre">warn_on_non_image_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.encoders.warn_on_non_image_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Do some basic checks to make sure the input image tensor looks like a
batch of stacked square frames. Good sanity check to make sure that
preprocessing is not being messed up somehow.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.losses">
<span id="il-representations-algos-losses-module"></span><h2>il_representations.algos.losses module<a class="headerlink" href="#module-il_representations.algos.losses" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.AELoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">AELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.AELoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>Compute the reconstruction (MSE) loss between the generated image and the original image.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.AsymmetricContrastiveLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">AsymmetricContrastiveLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.AsymmetricContrastiveLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>A basic contrastive loss that only does prediction/similarity comparison in one direction,
only calculating a softmax of IJ similarity against all similarities with I.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.losses.AsymmetricContrastiveLoss.calculate_logits_and_labels">
<span class="sig-name descname"><span class="pre">calculate_logits_and_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.AsymmetricContrastiveLoss.calculate_logits_and_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.BatchAsymmetricContrastiveLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">BatchAsymmetricContrastiveLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.BatchAsymmetricContrastiveLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.AsymmetricContrastiveLoss" title="il_representations.algos.losses.AsymmetricContrastiveLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.AsymmetricContrastiveLoss</span></code></a></p>
<p>This applies to algorithms that performs asymmetric contrast with samples in the same batch. i.e. Negative examples
come from all other images (and their augmented versions) in the same batch. Represents InfoNCE used in original
CPC paper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.losses.BatchAsymmetricContrastiveLoss.calculate_logits_and_labels">
<span class="sig-name descname"><span class="pre">calculate_logits_and_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.BatchAsymmetricContrastiveLoss.calculate_logits_and_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>z_i: dim (N, C). N - batch_size, C - representation dimension
z_j: dim (N, C). The augmented images’ representations</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.CEBLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">CEBLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.CEBLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>A variational contrastive loss that implements information bottlenecking, but in a less conservative form
than done by traditional VIB techniques</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.GaussianPriorLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">GaussianPriorLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.GaussianPriorLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>KL divergence between a Normal distribution prior on z and
the conditioned-on-x z distribution</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.MSELoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">MSELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.MSELoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>A loss that calculates Mean Squared Error between samples or means drawn from
target_dist and context_dist</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.NegativeLogLikelihood">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">NegativeLogLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.NegativeLogLikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>A version of negative log likelihood that directly calculates from distributions
Uses the mean of target_dist as ground truth, calculates log_prob under
decoded_context_dist, negates and averages across batch</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.QueueAsymmetricContrastiveLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">QueueAsymmetricContrastiveLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batch_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.QueueAsymmetricContrastiveLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.AsymmetricContrastiveLoss" title="il_representations.algos.losses.AsymmetricContrastiveLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.AsymmetricContrastiveLoss</span></code></a></p>
<p>This implements algorithms that use a queue to maintain all the negative examples. The contrastive loss is
calculated through the comparison of an image with its augmented version (positive example) and everything else
in the queue (negative examples). The method used in MoCo.</p>
<p>Alternatively, for higher sample efficiency, one may use (1) current batch’s augmented images, (2) current batch’s
original images, and (3) all the images in the queue as negative examples. This is implemented with setting
use_batch_neg=True.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.losses.QueueAsymmetricContrastiveLoss.calculate_logits_and_labels">
<span class="sig-name descname"><span class="pre">calculate_logits_and_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.QueueAsymmetricContrastiveLoss.calculate_logits_and_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>z_i: dim (N, C). N - batch_size, C - representation dimension
z_j: dim (N+K, C). K - number of entries in the queue.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.RepresentationLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">RepresentationLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.RepresentationLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.losses.RepresentationLoss.get_vector_forms">
<span class="sig-name descname"><span class="pre">get_vector_forms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.RepresentationLoss.get_vector_forms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.SymmetricContrastiveLoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">SymmetricContrastiveLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.SymmetricContrastiveLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>A contrastive loss that does prediction “in both directions,” i.e. that calculates logits of IJ similarity against
all similarities with J, and also all similarities with I, and calculates cross-entropy on both</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.losses.VAELoss">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.losses.</span></span><span class="sig-name descname"><span class="pre">VAELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.losses.VAELoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.losses.RepresentationLoss" title="il_representations.algos.losses.RepresentationLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.losses.RepresentationLoss</span></code></a></p>
<p>An additive combination of negative log likelihood and
KL divergence between a Normal distribution prior on z and
the conditioned-on-x z distribution</p>
<p>Note that beta of 1e-6 gives ~perfect autoencoding on finger-spin after
10,000 batches. Pushing it up to 1e-5 makes it slightly noisier. Starts to
struggle around 1e-4, and doesn’t learn anything around 1e-3.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.optimizers">
<span id="il-representations-algos-optimizers-module"></span><h2>il_representations.algos.optimizers module<a class="headerlink" href="#module-il_representations.algos.optimizers" title="Permalink to this headline">¶</a></h2>
<p>Layer-wise adaptive rate scaling for SGD in PyTorch!</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.optimizers.LARS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.optimizers.</span></span><span class="sig-name descname"><span class="pre">LARS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.optimizers.LARS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.optimizer.</span></code></p>
<p>Implements layer-wise adaptive rate scaling for SGD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>iterable</em>) – iterable of parameters to optimize or dicts defining
parameter groups</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – base learning rate (gamma_0)</p></li>
<li><p><strong>momentum</strong> (<em>float</em><em>, </em><em>optional</em>) – momentum factor (default: 0) (“m”)</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>optional</em>) – weight decay (L2 penalty) (default: 0)
(“beta”)</p></li>
<li><p><strong>eta</strong> (<em>float</em><em>, </em><em>optional</em>) – LARS coefficient</p></li>
<li><p><strong>max_epoch</strong> – maximum training epoch to determine polynomial LR decay.</p></li>
</ul>
</dd>
</dl>
<p>Based on Algorithm 1 of the following paper by You, Gitman, and Ginsburg.
Large Batch Training of Convolutional Networks:</p>
<blockquote>
<div><p><a class="reference external" href="https://arxiv.org/abs/1708.03888">https://arxiv.org/abs/1708.03888</a></p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">LARS</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.optimizers.LARS.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.optimizers.LARS.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>closure</strong> (<em>callable</em><em>, </em><em>optional</em>) – A closure that reevaluates the model
and returns the loss.</p></li>
<li><p><strong>epoch</strong> – current epoch to calculate polynomial LR decay schedule.
if None, uses self.epoch and increments it.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.pair_constructors">
<span id="il-representations-algos-pair-constructors-module"></span><h2>il_representations.algos.pair_constructors module<a class="headerlink" href="#module-il_representations.algos.pair_constructors" title="Permalink to this headline">¶</a></h2>
<p>Pair Constructors turn an iterator of temporally-ordered
observations/actions/etc. into a dataset of <cite>context</cite>, <cite>target</cite>, and
<cite>extra_context</cite> data elements, along with a metadata tensor containing the
trajectory ID and timestep ID for each element in the dataset. The iterator
should satisfy two invariants:</p>
<ul class="simple">
<li><p>First, it should yield observations and actions in the order they were
encountered in the environment (i.e. it should not interleave trajectories).</p></li>
<li><p>Second, each value it yields should be a dictionary with keys ‘obs’,
‘acts’, and ‘dones’. The corresponding values should each be numpy arrays
representing the relevant object at a single timestep (e.g. ‘acts’ should be
just a single action, not a sequence of actions).</p></li>
</ul>
<p>The <cite>context</cite> element is conceptually thought of as the element you’re using to
do prediction, whereas the <cite>target</cite> is the ground truth or “positive” we’re
trying to predict from the context, though this prediction framework is
admittedly a somewhat fuzzy match to the actual variety of techniques.</p>
<ul class="simple">
<li><p>In temporal contrastive loss settings, context is generally the element at
position (t), and target the element at position (t+k)</p></li>
<li><p>In pure-augmentation contrastive loss settings, context and target are the
same element (which will be augmented in different ways)</p></li>
<li><p>In a VAE, context and target are also the same element. Context will be
mapped into a representation and then decoded back out, whereas the target
will “tag along” as ground truth pixels needed to calculate the loss.</p></li>
<li><p>In Dynamics modeling, context is the current state at time (t), target is the
state at time (t+1) and extra context is the action taken at time (t)</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.pair_constructors.IdentityPairConstructor">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.pair_constructors.</span></span><span class="sig-name descname"><span class="pre">IdentityPairConstructor</span></span><a class="headerlink" href="#il_representations.algos.pair_constructors.IdentityPairConstructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.pair_constructors.TargetPairConstructor">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.pair_constructors.</span></span><span class="sig-name descname"><span class="pre">TargetPairConstructor</span></span><a class="headerlink" href="#il_representations.algos.pair_constructors.TargetPairConstructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.pair_constructors.TemporalOffsetPairConstructor">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.pair_constructors.</span></span><span class="sig-name descname"><span class="pre">TemporalOffsetPairConstructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporal_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.pair_constructors.TemporalOffsetPairConstructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.pair_constructors.TargetPairConstructor" title="il_representations.algos.pair_constructors.TargetPairConstructor"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.pair_constructors.TargetPairConstructor</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.algos.representation_learner">
<span id="il-representations-algos-representation-learner-module"></span><h2>il_representations.algos.representation_learner module<a class="headerlink" href="#module-il_representations.algos.representation_learner" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.RepresentationLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.representation_learner.</span></span><span class="sig-name descname"><span class="pre">RepresentationLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_calculator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_pair_constructor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_extender</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">representation_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_extra_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_pair_constructor_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmenter_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_extender_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_calculator_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_max_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.RepresentationLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.base_learner.BaseEnvironmentLearner" title="il_representations.algos.base_learner.BaseEnvironmentLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.base_learner.BaseEnvironmentLearner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.RepresentationLearner.all_trainable_params">
<span class="sig-name descname"><span class="pre">all_trainable_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.RepresentationLearner.all_trainable_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the trainable encoder parameters and the trainable decoder
parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.RepresentationLearner.batch_forward">
<span class="sig-name descname"><span class="pre">batch_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.RepresentationLearner.batch_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a forward pass on the given batch (from iterator generated by
the .make_data_iter() method). Returns (1) the computed loss, and (2)
a dictionary of detached tensors that are useful for debugging and
sanity checks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.RepresentationLearner.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batches_per_epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_log_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.optim.adam.Adam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trajs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.RepresentationLearner.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>Run repL training loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<em>[</em><em>wds.Dataset</em><em>]</em>) – list of webdataset datasets which we will
sample from. Each one likely represents data from different
tasks, or different policies.</p></li>
<li><p><strong>batches_per_epoch</strong> (<em>int</em>) – each ‘epoch’ simply consists of a fixed
number of batches, with data drawn equally from the given
datasets (as opposed to each epoch consisting of a complete
cycle through all datasets).</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – the total number of ‘epochs’ of optimisation to
perform. Total number of updates will be <cite>batches_per_epoch *
n_epochs</cite>.</p></li>
<li><p><strong>n_trajs</strong> (<em>int</em>) – the total number of trajectories we want to use
for training. The default ‘None’ will use the whole dataset.</p></li>
<li><p><strong>callbacks</strong> (<em>[</em><em>dict -&gt; None</em><em>]</em>) – list of functions to call at the
end of each batch, after computing the loss and updating the
network but before dumping logs. Will be provided with all
local variables.</p></li>
<li><p><strong>end_callbacks</strong> (<em>[</em><em>dict -&gt; None</em><em>]</em>) – these callbacks will only be
called once, at the end of training.</p></li>
<li><p><strong>log_dir</strong> (<em>str</em>) – directory to store checkpoints etc. to.</p></li>
<li><p><strong>log_interval</strong> (<em>int</em>) – num batches between log dumps.</p></li>
<li><p><strong>calc_log_interval</strong> (<em>int</em>) – how often to record statistics which will
be averaged in log dumps. Should generally be less than
log_interval.</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – how often to save encoder/decoder snapshots.</p></li>
<li><p><strong>scheduler_cls</strong> (<em>type</em>) – learning rate scheduler class.</p></li>
<li><p><strong>scheduler_kwargs</strong> (<em>dict</em>) – keyword args to pass to scheduler_cls.</p></li>
<li><p><strong>optimizer_cls</strong> (<em>type</em>) – optimizer class.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<em>dict</em>) – kwargs to pass to optimizer_cls.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns: tuple of <cite>(loss_record, most_recent_encoder_checkpoint_path)</cite>.</dt><dd><p><cite>loss_record</cite> is a list of average loss values encountered at each
epoch. <cite>most_recent_encoder_checkpoint_path</cite> is self-explanatory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.RepresentationLearner.make_data_iter">
<span class="sig-name descname"><span class="pre">make_data_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batches_per_epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trajs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.RepresentationLearner.make_data_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.RepresentationLearner.set_train">
<span class="sig-name descname"><span class="pre">set_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.RepresentationLearner.set_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Put modules in train mode (val=True) or test mode (val=False).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.get_default_args">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.representation_learner.</span></span><span class="sig-name descname"><span class="pre">get_default_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.get_default_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.representation_learner.to_dict">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.representation_learner.</span></span><span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs_element</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.representation_learner.to_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-il_representations.algos.utils">
<span id="il-representations-algos-utils-module"></span><h2>il_representations.algos.utils module<a class="headerlink" href="#module-il_representations.algos.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.utils.AverageMeter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">AverageMeter</span></span><a class="headerlink" href="#il_representations.algos.utils.AverageMeter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.utils.AverageMeter.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.AverageMeter.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.utils.AverageMeter.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.AverageMeter.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.utils.LinearWarmupCosine">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">LinearWarmupCosine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.LinearWarmupCosine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.utils.LinearWarmupCosine.get_lr">
<span class="sig-name descname"><span class="pre">get_lr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.LinearWarmupCosine.get_lr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.utils.Logger">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.Logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.utils.Logger.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.Logger.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.accuracy">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the precision&#64;k for the specified values of k</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.add_noise">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std_dev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.add_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.gaussian_blur">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">gaussian_blur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.gaussian_blur" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.independent_multivariate_normal">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">independent_multivariate_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.independent_multivariate_normal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.plot">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.plot_single">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">plot_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.plot_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.save_model">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.save_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.set_global_seeds">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">set_global_seeds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.set_global_seeds" title="Permalink to this definition">¶</a></dt>
<dd><p>set the seed for python random, tensorflow, numpy and gym spaces</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – (int or None) the seed</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.show_image">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">show_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.show_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.show_plt_image">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">show_plt_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.show_plt_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.utils.time_now">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.utils.</span></span><span class="sig-name descname"><span class="pre">time_now</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.utils.time_now" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-il_representations.algos">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-il_representations.algos" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.ActionConditionedTemporalCPC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">ActionConditionedTemporalCPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.ActionConditionedTemporalCPC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Implementation of reinforcement-learning-specific variant of Temporal CPC which adds a projection layer on top
of the learned representation which integrates an encoding of the actions taken between time (t) and whatever
time (t+k) is specified in temporal_offset and used for pulling out the target frame. This, notionally, allows
the algorithm to construct frame representations that are action-independent, rather than marginalizing over an
expected policy, as might need to happen if the algorithm needed to predict the frame at time (t+k) over any
possible action distribution.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.ActionConditionedTemporalVAE">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">ActionConditionedTemporalVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.ActionConditionedTemporalVAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Essentially the same as a DynamicsModel, but with learned standard deviation (learn_scale=True) and
VAELoss instead of MSELoss</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.Autoencoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">Autoencoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.Autoencoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>A basic autoencoder that tries to reconstruct the
current frame, and calculates an MSE loss over current frame pixels,
using reconstruction loss.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.BYOL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">BYOL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.BYOL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Implementation of Bootstrap Your Own Latent: <a class="reference external" href="https://arxiv.org/pdf/2006.07733.pdf">https://arxiv.org/pdf/2006.07733.pdf</a></p>
<p>The hyperparameters do _not_ match those in the paper (see Section 3.2).
Most notably, the momentum weight is set to a constant, instead of annealed
from 0.996 to 1 via cosine scheduling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="il_representations.algos.BYOL.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.BYOL.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>Run repL training loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<em>[</em><em>wds.Dataset</em><em>]</em>) – list of webdataset datasets which we will
sample from. Each one likely represents data from different
tasks, or different policies.</p></li>
<li><p><strong>batches_per_epoch</strong> (<em>int</em>) – each ‘epoch’ simply consists of a fixed
number of batches, with data drawn equally from the given
datasets (as opposed to each epoch consisting of a complete
cycle through all datasets).</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – the total number of ‘epochs’ of optimisation to
perform. Total number of updates will be <cite>batches_per_epoch *
n_epochs</cite>.</p></li>
<li><p><strong>n_trajs</strong> (<em>int</em>) – the total number of trajectories we want to use
for training. The default ‘None’ will use the whole dataset.</p></li>
<li><p><strong>callbacks</strong> (<em>[</em><em>dict -&gt; None</em><em>]</em>) – list of functions to call at the
end of each batch, after computing the loss and updating the
network but before dumping logs. Will be provided with all
local variables.</p></li>
<li><p><strong>end_callbacks</strong> (<em>[</em><em>dict -&gt; None</em><em>]</em>) – these callbacks will only be
called once, at the end of training.</p></li>
<li><p><strong>log_dir</strong> (<em>str</em>) – directory to store checkpoints etc. to.</p></li>
<li><p><strong>log_interval</strong> (<em>int</em>) – num batches between log dumps.</p></li>
<li><p><strong>calc_log_interval</strong> (<em>int</em>) – how often to record statistics which will
be averaged in log dumps. Should generally be less than
log_interval.</p></li>
<li><p><strong>save_interval</strong> (<em>int</em>) – how often to save encoder/decoder snapshots.</p></li>
<li><p><strong>scheduler_cls</strong> (<em>type</em>) – learning rate scheduler class.</p></li>
<li><p><strong>scheduler_kwargs</strong> (<em>dict</em>) – keyword args to pass to scheduler_cls.</p></li>
<li><p><strong>optimizer_cls</strong> (<em>type</em>) – optimizer class.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<em>dict</em>) – kwargs to pass to optimizer_cls.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns: tuple of <cite>(loss_record, most_recent_encoder_checkpoint_path)</cite>.</dt><dd><p><cite>loss_record</cite> is a list of average loss values encountered at each
epoch. <cite>most_recent_encoder_checkpoint_path</cite> is self-explanatory.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.CEB">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">CEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.CEB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>CEB with variance that is learned by StochasticEncoder</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.ContrastiveInverseDynamicsPrediction">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">ContrastiveInverseDynamicsPrediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.ContrastiveInverseDynamicsPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Like InverseDynamicsPrediction above, except it uses a contrastive loss function.</p>
<p>A contrastive loss here means we predict a representation of the action given the
current and next state, and try to match that against the embedding of the true
action, with negatives provided by the embedding of other actions in the batch.</p>
<p>During the decoder stage, instead of predicting an action, we simply concatenate
the representations of s and s’ together, and then predict an action representation
from the concatenation using a projection head. During the encoder stage, we need to
also encode the actions.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.DynamicsPrediction">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">DynamicsPrediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.DynamicsPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>A basic form of Dynamics modeling, predicting the pixels of the next frame
given the current frame and the current actions. Uses transposed convolutions
to do pixel predictions, and a MSE loss to calculate error w.r.t next frame</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.FixedVarianceCEB">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">FixedVarianceCEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.FixedVarianceCEB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>CEB with fixed rather than learned variance</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.FixedVarianceTargetProjectedCEB">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">FixedVarianceTargetProjectedCEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.FixedVarianceTargetProjectedCEB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>CEB with a fixed (rather than learned) variance that also has a projection layer
to more closely mimic a learned bilinear loss</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.GaussianPriorControl">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">GaussianPriorControl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.GaussianPriorControl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.InverseDynamicsPrediction">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">InverseDynamicsPrediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.InverseDynamicsPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>An implementation of an inverse dynamics model that tries to predict the action taken
in between two successive frames, given representations of those frames</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.MoCo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">MoCo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.MoCo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Implementation of MoCo: Momentum Contrast for Unsupervised Visual Representation Learning.
<a class="reference external" href="https://arxiv.org/abs/1911.05722">https://arxiv.org/abs/1911.05722</a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.RecurrentCPC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">RecurrentCPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.RecurrentCPC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Implementation of a recurrent version of CPC: Contrastive Predictive Coding
<a class="reference external" href="https://arxiv.org/abs/1807.03748">https://arxiv.org/abs/1807.03748</a></p>
<p>The encoder first encodes individual frames for both context and target, and then, for the context,
builds up a recurrent representation of all prior frames in the same trajectory, to use to predict the target.</p>
<p>By default, augments only the context, but can be modified to augment both context and target.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.SimCLR">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">SimCLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.SimCLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>Implementation of SimCLR: A Simple Framework for Contrastive Learning of Visual Representations
<a class="reference external" href="https://arxiv.org/abs/2002.05709">https://arxiv.org/abs/2002.05709</a></p>
<p>This method works by using a contrastive loss to push together representations of two differently-augmented
versions of the same image. In particular, it uses a symmetric contrastive loss, which compares the
(target, context) similarity against similarity of context with all other targets, and also similarity</p>
<blockquote>
<div><p>of target with all other contexts.</p>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.TemporalCPC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">TemporalCPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.TemporalCPC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.algos.VariationalAutoencoder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">VariationalAutoencoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.VariationalAutoencoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#il_representations.algos.representation_learner.RepresentationLearner" title="il_representations.algos.representation_learner.RepresentationLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">il_representations.algos.representation_learner.RepresentationLearner</span></code></a></p>
<p>A basic variational autoencoder that tries to reconstruct the
current frame, and calculates a VAE loss over current frame pixels,
using reconstruction loss and a KL divergence between learned
z distribution and a normal prior</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.get_action_representation_dim">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">get_action_representation_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.get_action_representation_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer what dimension of action representation will be produced by an encoder with the given
<cite>encoder_kwargs</cite> operating on the given <cite>action_space</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.algos.validate_and_update_kwargs">
<span class="sig-prename descclassname"><span class="pre">il_representations.algos.</span></span><span class="sig-name descname"><span class="pre">validate_and_update_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo_hardcoded_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.algos.validate_and_update_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="il_representations.configs.html" class="btn btn-neutral float-right" title="il_representations.configs package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="il_representations.html" class="btn btn-neutral float-left" title="il_representations package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Center for Human-Compatible AI.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>