

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>il_representations.data package &mdash; Representations for Sequence Learning 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="il_representations.envs package" href="il_representations.envs.html" />
    <link rel="prev" title="il_representations.configs package" href="il_representations.configs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Representations for Sequence Learning
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">il_representations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="il_representations.html">il_representations package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="il_representations.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="il_representations.algos.html">il_representations.algos package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.configs.html">il_representations.configs package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">il_representations.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.envs.html">il_representations.envs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.il.html">il_representations.il package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.scripts.html">il_representations.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="il_representations.test_support.html">il_representations.test_support package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.pol_eval">il_representations.pol_eval module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.policy_interfacing">il_representations.policy_interfacing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.script_utils">il_representations.script_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations.utils">il_representations.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="il_representations.html#module-il_representations">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Representations for Sequence Learning</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">il_representations</a> &raquo;</li>
        
          <li><a href="il_representations.html">il_representations package</a> &raquo;</li>
        
      <li>il_representations.data package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/il_representations.data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="il-representations-data-package">
<h1>il_representations.data package<a class="headerlink" href="#il-representations-data-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-il_representations.data.read_dataset">
<span id="il-representations-data-read-dataset-module"></span><h2>il_representations.data.read_dataset module<a class="headerlink" href="#module-il_representations.data.read_dataset" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading datasets stored in the webdataset format.</p>
<dl class="py class">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.ILRDataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.data.read_dataset.</span></span><span class="sig-name descname"><span class="pre">ILRDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.read_dataset.ILRDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">webdataset.webdataset.Dataset._name</span></code></p>
<p>Modification of webdataset’s <cite>Dataset</cite> class so that it is suitable for
il-representations. Specific changes:</p>
<ul class="simple">
<li><p>It looks for a <cite>_metadata.meta.pickle</cite> file at the beginning of the data
archive &amp; makes it available as a class attribute (<cite>.meta</cite>). This is
useful for storing dataset-global metadata.</p></li>
<li><p>(possibly some other stuff, I haven’t figured it out yet)</p></li>
</ul>
<dl class="py property">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.ILRDataset.meta">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">meta</span></span><a class="headerlink" href="#il_representations.data.read_dataset.ILRDataset.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.InterleavedDataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.data.read_dataset.</span></span><span class="sig-name descname"><span class="pre">InterleavedDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.read_dataset.InterleavedDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.torch.utils.data.IterableDataset._name</span></code></p>
<p>Randomly interleaves one or more IterableDatasets. Pretends that the
resulting dataset has length <cite>nominal_length</cite>; underlying datasets are
looped as needed, like in WDS’ ResizeDataset.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.SubdatasetExtractor">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">il_representations.data.read_dataset.</span></span><span class="sig-name descname"><span class="pre">SubdatasetExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_trajs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.read_dataset.SubdatasetExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.datasets_to_loader">
<span class="sig-prename descclassname"><span class="pre">il_representations.data.read_dataset.</span></span><span class="sig-name descname"><span class="pre">datasets_to_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nominal_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle_buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.read_dataset.datasets_to_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a sequence of webdataset <a href="#id1"><span class="problematic" id="id2">`</span></a>Dataset`s into a single Torch data
loader that mixes the datasets equally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<em>[</em><em>Dataset</em><em>]</em>) – sequence of datasets to mix.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – size of batches to yield.</p></li>
<li><p><strong>nominal_length</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – supposed length of the dataset (number
of samples, not number of batches). This governs how long you
can draw samples from the <cite>DataLoader</cite> for before it raises
<cite>StopIteration</cite>. If you aren’t relying on <cite>DataLoader</cite> raising
<cite>StopIteration</cite>, then you can make this “length” as large as you
like.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) – should we use an intermediate buffer to shuffle
samples, after applying preprocessors but before forming batches?</p></li>
<li><p><strong>shuffle_buffer_size</strong> (<em>int</em>) – size of the intermediate buffer to use for
shuffling.</p></li>
<li><p><strong>max_workers</strong> (<em>int</em>) – number of workers to use for data loader.</p></li>
<li><p><strong>preprocessors</strong> (<em>[</em><em>fn</em><em>]</em>) – a list of preprocessors which will be applied to
each dataset using <cite>.pipe()</cite>. Note that these preprocessors get to
see samples in the order they were written to disk, which can be
useful for things like target pair construction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>a Torch DataLoader that returns batches</dt><dd><p>of the required size, with elements drawn with equal probability
from all constituent datasets.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>data_loader (torch.DataLoader)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.load_ilr_datasets">
<span class="sig-prename descclassname"><span class="pre">il_representations.data.read_dataset.</span></span><span class="sig-name descname"><span class="pre">load_ilr_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_paths</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.read_dataset.load_ilr_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a dataset that has been stored in webdataset format, given a list
of file paths representing shards of the dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.data.read_dataset.strip_extensions">
<span class="sig-prename descclassname"><span class="pre">il_representations.data.read_dataset.</span></span><span class="sig-name descname"><span class="pre">strip_extensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.read_dataset.strip_extensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip extensions from the keys in dicts generated by ILRDataset.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.data.write_dataset">
<span id="il-representations-data-write-dataset-module"></span><h2>il_representations.data.write_dataset module<a class="headerlink" href="#module-il_representations.data.write_dataset" title="Permalink to this headline">¶</a></h2>
<p>Utilities for writing datasets in the webdataset format.</p>
<dl class="py function">
<dt class="sig sig-object py" id="il_representations.data.write_dataset.get_meta_dict">
<span class="sig-prename descclassname"><span class="pre">il_representations.data.write_dataset.</span></span><span class="sig-name descname"><span class="pre">get_meta_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#il_representations.data.write_dataset.get_meta_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a dictionary with metadata for the current task (as defined by
<cite>env_cfg</cite>). When generating a webdataset, this dictionary will be written
to the beginning of each shard. Having this metadata in the file makes it
possible to determine how big the inputs to CNNs are, what sort of action
space should be used for each task, etc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="il_representations.data.write_dataset.write_frames">
<span class="sig-prename descclassname"><span class="pre">il_representations.data.write_dataset.</span></span><span class="sig-name descname"><span class="pre">write_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_dicts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#il_representations.data.write_dataset.write_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a series of frames to a webdataset shard. This function also makes
sure to write the metadata dictionary <cite>meta_dict</cite> at the beginning of the
shard, as expected by the data-loading utilities in <cite>read_dataset.py</cite>.</p>
</dd></dl>

</div>
<div class="section" id="module-il_representations.data">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-il_representations.data" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="il_representations.envs.html" class="btn btn-neutral float-right" title="il_representations.envs package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="il_representations.configs.html" class="btn btn-neutral float-left" title="il_representations.configs package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Center for Human-Compatible AI.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>